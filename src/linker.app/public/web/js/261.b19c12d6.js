"use strict";(self["webpackChunklinker_web"]=self["webpackChunklinker_web"]||[]).push([[261],{25261:function(e,l,a){a.r(l),a.d(l,{default:function(){return $}});var t=a(56768),o=a(24232);const n=e=>((0,t.Qi)("data-v-280c6e06"),e=e(),(0,t.jt)(),e),r={class:"logger-setting-wrap flex flex-column h-100",ref:"wrap"},g={class:"inner"},s={class:"head flex"},i=n((()=>(0,t.Lk)("span",{class:"flex-1"},null,-1))),d={class:"body flex-1 relative"},u={class:"pages t-c"},b={class:"page-wrap"};function c(e,l,a,n,c,p){const m=(0,t.g2)("el-option"),f=(0,t.g2)("el-select"),h=(0,t.g2)("el-button"),k=(0,t.g2)("el-table-column"),v=(0,t.g2)("el-table"),w=(0,t.g2)("el-pagination"),y=(0,t.g2)("el-tab-pane"),F=(0,t.g2)("Setting"),L=(0,t.g2)("el-tabs");return(0,t.uX)(),(0,t.CE)("div",r,[(0,t.bF)(L,{type:"border-card",class:"w-100"},{default:(0,t.k6)((()=>[n.hasLogger?((0,t.uX)(),(0,t.Wv)(y,{key:0,label:e.$t("logger.list")},{default:(0,t.k6)((()=>[(0,t.Lk)("div",g,[(0,t.Lk)("div",s,[(0,t.Lk)("div",null,[(0,t.bF)(f,{modelValue:n.state.type,"onUpdate:modelValue":l[0]||(l[0]=e=>n.state.type=e),onChange:n.loadData,size:"small",class:"mgr-1",style:{width:"6rem"}},{default:(0,t.k6)((()=>[(0,t.bF)(m,{value:-1,label:"all"}),(0,t.bF)(m,{value:0,label:"debug"}),(0,t.bF)(m,{value:1,label:"info"}),(0,t.bF)(m,{value:2,label:"warning"}),(0,t.bF)(m,{value:3,label:"error"}),(0,t.bF)(m,{value:4,label:"fatal"})])),_:1},8,["modelValue","onChange"])]),(0,t.bF)(h,{type:"warning",size:"small",loading:n.state.loading,onClick:n.clearData},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.$t("logger.clear")),1)])),_:1},8,["loading","onClick"]),(0,t.bF)(h,{size:"small",loading:n.state.loading,onClick:n.loadData},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.$t("logger.refresh")),1)])),_:1},8,["loading","onClick"]),i]),(0,t.Lk)("div",d,[(0,t.bF)(v,{stripe:"",border:"",data:n.state.page.List,size:"small",height:`${n.state.height}px`,width:"100%",onRowClick:n.handleRowClick,"row-class-name":n.tableRowClassName},{default:(0,t.k6)((()=>[(0,t.bF)(k,{type:"index",width:"50"}),(0,t.bF)(k,{prop:"Type",label:e.$t("logger.level"),width:"80"},{default:(0,t.k6)((e=>[(0,t.Lk)("span",null,(0,o.v_)(n.state.types[e.row.Type]),1)])),_:1},8,["label"]),(0,t.bF)(k,{prop:"Time",label:e.$t("logger.time"),width:"160"},null,8,["label"]),(0,t.bF)(k,{prop:"content",label:e.$t("logger.content")},null,8,["label"])])),_:1},8,["data","height","onRowClick","row-class-name"])]),(0,t.Lk)("div",u,[(0,t.Lk)("div",b,[(0,t.bF)(w,{small:"",total:n.state.page.Count,currentPage:n.state.page.Page,"onUpdate:currentPage":l[1]||(l[1]=e=>n.state.page.Page=e),"page-size":n.state.page.Size,"pager-count":n.globalData.isPc?7:3,layout:n.globalData.isPc?"total,prev, pager, next":"prev, pager, next",onCurrentChange:n.handlePageChange,background:""},null,8,["total","currentPage","page-size","pager-count","layout","onCurrentChange"])])])])])),_:1},8,["label"])):(0,t.Q3)("",!0),n.hasLoggerLevel?((0,t.uX)(),(0,t.Wv)(y,{key:1,label:e.$t("common.setting")},{default:(0,t.k6)((()=>[(0,t.bF)(F)])),_:1},8,["label"])):(0,t.Q3)("",!0)])),_:1})],512)}var p=a(90144),m=a(10004);const f=e=>(0,m.zG)("logger/get",e),h=()=>(0,m.zG)("logger/clear"),k=()=>(0,m.zG)("logger/getconfig"),v=e=>(0,m.zG)("logger/setconfig",e),w={class:"t-c w-100"};function y(e,l,a,n,r,g){const s=(0,t.g2)("el-input"),i=(0,t.g2)("el-form-item"),d=(0,t.g2)("el-col"),u=(0,t.g2)("el-option"),b=(0,t.g2)("el-select"),c=(0,t.g2)("el-row"),p=(0,t.g2)("el-button"),m=(0,t.g2)("el-form"),f=(0,t.gN)("trim");return(0,t.uX)(),(0,t.Wv)(m,{"label-width":"8rem",ref:"formDom",model:n.state.form,rules:n.state.rules},{default:(0,t.k6)((()=>[(0,t.bF)(i,{label:"","label-width":"0"},{default:(0,t.k6)((()=>[(0,t.bF)(c,null,{default:(0,t.k6)((()=>[(0,t.bF)(d,{xs:24,sm:8,md:8,lg:8,xl:8},{default:(0,t.k6)((()=>[(0,t.bF)(i,{label:e.$t("logger.count"),prop:"Size"},{default:(0,t.k6)((()=>[(0,t.bo)((0,t.bF)(s,{size:"default",modelValue:n.state.form.Size,"onUpdate:modelValue":l[0]||(l[0]=e=>n.state.form.Size=e)},null,8,["modelValue"]),[[f]])])),_:1},8,["label"])])),_:1}),(0,t.bF)(d,{xs:24,sm:8,md:8,lg:8,xl:8},{default:(0,t.k6)((()=>[(0,t.bF)(i,{label:e.$t("logger.level"),prop:"LoggerType"},{default:(0,t.k6)((()=>[(0,t.bF)(b,{modelValue:n.state.form.LoggerType,"onUpdate:modelValue":l[1]||(l[1]=e=>n.state.form.LoggerType=e)},{default:(0,t.k6)((()=>[(0,t.bF)(u,{value:0,label:"debug"}),(0,t.bF)(u,{value:1,label:"info"}),(0,t.bF)(u,{value:2,label:"warning"}),(0,t.bF)(u,{value:3,label:"error"}),(0,t.bF)(u,{value:4,label:"fatal"})])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(i,{"label-width":"0"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",w,[(0,t.bF)(p,{type:"primary",loading:n.state.loading,onClick:n.submit},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.$t("common.confirm")),1)])),_:1},8,["loading","onClick"])])])),_:1})])),_:1},8,["model","rules"])}var F=a(51219),L={setup(){const e=(0,p.KR)(null),l=(0,p.Kh)({loading:!1,configInfo:{},form:{Size:0,LoggerType:-1},rules:{Size:[{required:!0,message:"必填",trigger:"blur"},{type:"number",min:1,max:1e4,message:"数字 1-10000",trigger:"blur",transform(e){return Number(e)}}]}}),a=()=>{k().then((e=>{l.configInfo=e,l.form.Size=e.Size,l.form.LoggerType=e.LoggerType})).catch((e=>{}))},o=()=>{let e=JSON.parse(JSON.stringify(l.configInfo));return e.Size=+l.form.Size,e.LoggerType=+l.form.LoggerType,e},n=()=>new Promise(((a,t)=>{e.value.validate((e=>{if(0==e)return t(),!1;l.loading=!0;const n=o();v(n).then((e=>{l.loading=!1,a(),e?F.nk.success("操作成功!"):F.nk.error("操作失败!")})).catch((e=>{console.log(e),l.loading=!1,a()}))}))}));return(0,t.sV)((()=>{a()})),{state:l,formDom:e,submit:n}}},_=a(71241);const C=(0,_.A)(L,[["render",y],["__scopeId","data-v-9857fa74"]]);var z=C,x=a(12933),S=a(53830),P={components:{Setting:z},setup(){const e=(0,S.B)(),l=(0,p.EW)((()=>e.value.hasAccess("LoggerShow"))),a=(0,p.EW)((()=>e.value.hasAccess("LoggerLevel"))),o=(0,p.KR)(null),n=(0,p.Kh)({loading:!0,type:-1,page:{Page:1,Size:20,Count:0,List:[]},types:["debug","info","warning","error","fatal"],height:(0,p.EW)((()=>e.value.height-180))}),r=()=>{n.loading=!0,f({Page:n.page.Page,Size:n.page.Size,Type:n.type}).then((e=>{n.loading=!1,e.List.map((e=>{e.content=e.Content.substring(0,50)})),n.page=e})).catch((e=>{console.log(e),n.loading=!1}))},g=e=>{e&&(n.page.Page=e,r())},s=()=>{n.loading=!0,h().then((()=>{n.loading=!1,r()})).catch((()=>{n.loading=!1}))},i=({row:e,rowIndex:l})=>`type-${e.Type}`,d=(e,l,a)=>{let t="padding:1rem;border:1px solid #ddd; resize:none;width:30rem;box-sizing: border-box;white-space: nowrap; height:30rem;";x.s.alert(`<textarea class="scrollbar-4" style="${t}">${e.Content}</textarea>`,"",{dangerouslyUseHTMLString:!0}).catch((()=>{}))};return(0,t.sV)((()=>{r()})),{globalData:e,hasLogger:l,hasLoggerLevel:a,wrap:o,state:n,loadData:r,clearData:s,tableRowClassName:i,handleRowClick:d,handlePageChange:g}}};const T=(0,_.A)(P,[["render",c],["__scopeId","data-v-280c6e06"]]);var $=T}}]);